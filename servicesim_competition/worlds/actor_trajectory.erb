<%
  # Template to generate an animated actor which moves along a given trajectory.
  #
  # Required variables
  # * $actor_name (string) Unique name for the actor
  # * $actor_skin (string) A skin Collada file from model://actor/meshes/
  # * $actor_anim (string) An animation Collada file from model://actor/meshes/
  # * $actor_velocity (double) Velocity for trajectory actors, in m/s
  # * $actor_trajectory (array[array[6]]) Array or waypoint poses
%>

<actor name="<%= $actor_name %>">

  <!-- Starting pose, nice for when the world is reset -->
  <pose>
    <%= $actor_trajectory[0][0] %>
    <%= $actor_trajectory[0][1] %>
    <%= $actor_trajectory[0][2] %>
    <%= $actor_trajectory[0][3] %>
    <%= $actor_trajectory[0][4] %>
    <%= $actor_trajectory[0][5] %>
  </pose>

  <skin>
    <filename>model://actor/meshes/<%= $actor_skin %></filename>
  </skin>

  <animation name="animation">
    <filename>model://actor/meshes/<%= $actor_anim %></filename>
    <interpolate_x>true</interpolate_x>
  </animation>

  <plugin name="trajectory" filename="libTrajectoryActorPlugin.so">
    <%
      for pose in $actor_trajectory
    %>
      <target>
        <%= pose[0] %>
        <%= pose[1] %>
        <%= pose[2] %>
        <%= pose[3] %>
        <%= pose[4] %>
        <%= pose[5] %>
      </target>
    <% end %>

    <velocity><%= $actor_velocity %></velocity>
    <obstacle_margin>0.0</obstacle_margin>
    <ignore_obstacle>walls</ignore_obstacle>
    <ignore_obstacle>floor</ignore_obstacle>
    <!-- FIXME: servicebot's bounding box is huge and always colliding -->
    <ignore_obstacle>servicebot</ignore_obstacle>

  </plugin>

</actor>
